{"id":"../node_modules/nem-sdk/build/model/transactions/transferTransaction.js","dependencies":[{"name":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/transactions/transferTransaction.js.map","includedInParent":true,"mtime":1555063524390},{"name":"/Users/yugo/Dropbox/Programing/NEM/streetnems/package.json","includedInParent":true,"mtime":1555063526179},{"name":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/package.json","includedInParent":true,"mtime":1555063516168},{"name":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/.babelrc","includedInParent":true,"mtime":1530213456000},{"name":"../network","loc":{"line":3,"column":23},"parent":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/transactions/transferTransaction.js","resolved":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/network.js"},{"name":"../../utils/helpers","loc":{"line":7,"column":23},"parent":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/transactions/transferTransaction.js","resolved":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/utils/helpers.js"},{"name":"../transactionTypes","loc":{"line":11,"column":32},"parent":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/transactions/transferTransaction.js","resolved":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/transactionTypes.js"},{"name":"../fees","loc":{"line":15,"column":20},"parent":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/transactions/transferTransaction.js","resolved":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/fees.js"},{"name":"../../crypto/keyPair","loc":{"line":19,"column":23},"parent":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/transactions/transferTransaction.js","resolved":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/crypto/keyPair.js"},{"name":"../objects","loc":{"line":23,"column":23},"parent":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/transactions/transferTransaction.js","resolved":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/objects.js"},{"name":"./multisigWrapper","loc":{"line":27,"column":31},"parent":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/transactions/transferTransaction.js","resolved":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/transactions/multisigWrapper.js"},{"name":"./message","loc":{"line":31,"column":23},"parent":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/transactions/transferTransaction.js","resolved":"/Users/yugo/Dropbox/Programing/NEM/streetnems/node_modules/nem-sdk/build/model/transactions/message.js"}],"generated":{"js":"'use strict';\n\nvar _network = require('../network');\n\nvar _network2 = _interopRequireDefault(_network);\n\nvar _helpers = require('../../utils/helpers');\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nvar _transactionTypes = require('../transactionTypes');\n\nvar _transactionTypes2 = _interopRequireDefault(_transactionTypes);\n\nvar _fees = require('../fees');\n\nvar _fees2 = _interopRequireDefault(_fees);\n\nvar _keyPair = require('../../crypto/keyPair');\n\nvar _keyPair2 = _interopRequireDefault(_keyPair);\n\nvar _objects = require('../objects');\n\nvar _objects2 = _interopRequireDefault(_objects);\n\nvar _multisigWrapper = require('./multisigWrapper');\n\nvar _multisigWrapper2 = _interopRequireDefault(_multisigWrapper);\n\nvar _message = require('./message');\n\nvar _message2 = _interopRequireDefault(_message);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Prepare a transfer transaction object\n *\n * @param {object} common - A common object\n * @param {object} tx - The un-prepared transfer transaction object\n * @param {number} network - A network id\n *\n * @return {object} - A [TransferTransaction]{@link http://bob.nem.ninja/docs/#transferTransaction} object ready for serialization\n */\nvar prepare = function prepare(common, tx, network) {\n    if (!common || !tx || !network) throw new Error('Missing parameter !');\n    var kp = _keyPair2.default.create(_helpers2.default.fixPrivateKey(common.privateKey));\n    var actualSender = tx.isMultisig ? tx.multisigAccount.publicKey : kp.publicKey.toString();\n    var recipientCompressedKey = tx.recipient.toString();\n    var amount = Math.round(tx.amount * 1000000);\n    var message = _message2.default.prepare(common, tx);\n    var msgFee = _fees2.default.calculateMessage(message, common.isHW);\n    var due = network === _network2.default.data.testnet.id ? 60 : 24 * 60;\n    var mosaics = null;\n    var mosaicsFee = null;\n    var entity = _construct(actualSender, recipientCompressedKey, amount, message, msgFee, due, mosaics, mosaicsFee, network);\n    if (tx.isMultisig) {\n        entity = (0, _multisigWrapper2.default)(kp.publicKey.toString(), entity, due, network);\n    }\n    return entity;\n};\n\n/**\n * Prepare a mosaic transfer transaction object\n *\n * @param {object} common - A common object\n * @param {object} tx - The un-prepared transfer transaction object\n * @param {object} mosaicDefinitionMetaDataPair - The mosaicDefinitionMetaDataPair object with properties of mosaics to send\n * @param {number} network - A network id\n *\n * @return {object} - A [TransferTransaction]{@link http://bob.nem.ninja/docs/#transferTransaction} object ready for serialization\n */\nvar prepareMosaic = function prepareMosaic(common, tx, mosaicDefinitionMetaDataPair, network) {\n    if (!common || !tx || !mosaicDefinitionMetaDataPair || tx.mosaics === null || !network) throw new Error('Missing parameter !');\n    var kp = _keyPair2.default.create(_helpers2.default.fixPrivateKey(common.privateKey));\n    var actualSender = tx.isMultisig ? tx.multisigAccount.publicKey : kp.publicKey.toString();\n    var recipientCompressedKey = tx.recipient.toString();\n    var amount = Math.round(tx.amount * 1000000);\n    var message = _message2.default.prepare(common, tx);\n    var msgFee = _fees2.default.calculateMessage(message, common.isHW);\n    var due = network === _network2.default.data.testnet.id ? 60 : 24 * 60;\n    var mosaics = tx.mosaics;\n    var mosaicsFee = _fees2.default.calculateMosaics(amount, mosaicDefinitionMetaDataPair, mosaics);\n    var entity = _construct(actualSender, recipientCompressedKey, amount, message, msgFee, due, mosaics, mosaicsFee, network);\n    if (tx.isMultisig) {\n        entity = (0, _multisigWrapper2.default)(kp.publicKey.toString(), entity, due, network);\n    }\n    return entity;\n};\n\n/***\n * Create a transfer transaction object\n *\n * @param {string} senderPublicKey - The sender account public key\n * @param {string} recipientCompressedKey - The recipient account public key\n * @param {number} amount - The amount to send in micro XEM\n * @param {object} message - The message object\n * @param {number} due - The deadline in minutes\n * @param {array} mosaics - The array of mosaics to send\n * @param {number} mosaicFee - The fees for mosaics included in the transaction\n * @param {number} network - A network id\n *\n * @return {object} - A [TransferTransaction]{@link http://bob.nem.ninja/docs/#transferTransaction} object\n */\nvar _construct = function _construct(senderPublicKey, recipientCompressedKey, amount, message, msgFee, due, mosaics, mosaicsFee, network) {\n    var timeStamp = _helpers2.default.createNEMTimeStamp();\n    var version = mosaics ? _network2.default.getVersion(2, network) : _network2.default.getVersion(1, network);\n    var data = _objects2.default.create(\"commonTransactionPart\")(_transactionTypes2.default.transfer, senderPublicKey, timeStamp, due, version);\n    var fee = mosaics ? mosaicsFee : _fees2.default.currentFeeFactor * _fees2.default.calculateMinimum(amount / 1000000);\n    var totalFee = Math.floor((msgFee + fee) * 1000000);\n    var custom = {\n        'recipient': recipientCompressedKey.toUpperCase().replace(/-/g, ''),\n        'amount': amount,\n        'fee': totalFee,\n        'message': message,\n        'mosaics': mosaics\n    };\n    var entity = _helpers2.default.extendObj(data, custom);\n    return entity;\n};\n\nmodule.exports = {\n    prepare: prepare,\n    prepareMosaic: prepareMosaic\n};\n"},"sourceMaps":{"js":{"version":3,"sources":["../../../src/model/transactions/transferTransaction.js"],"names":["prepare","common","tx","network","Error","kp","KeyPair","create","Helpers","fixPrivateKey","privateKey","actualSender","isMultisig","multisigAccount","publicKey","toString","recipientCompressedKey","recipient","amount","Math","round","message","Message","msgFee","Fees","calculateMessage","isHW","due","Network","data","testnet","id","mosaics","mosaicsFee","entity","_construct","prepareMosaic","mosaicDefinitionMetaDataPair","calculateMosaics","senderPublicKey","timeStamp","createNEMTimeStamp","version","getVersion","Objects","TransactionTypes","transfer","fee","currentFeeFactor","calculateMinimum","totalFee","floor","custom","toUpperCase","replace","extendObj","module","exports"],"mappings":"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","file":"transferTransaction.js","sourcesContent":["import Network from '../network';\nimport Helpers from '../../utils/helpers';\nimport TransactionTypes from '../transactionTypes';\nimport Fees from '../fees';\nimport KeyPair from '../../crypto/keyPair';\nimport Objects from '../objects';\nimport MultisigWrapper from './multisigWrapper';\nimport Message from './message';\n\n/**\n * Prepare a transfer transaction object\n *\n * @param {object} common - A common object\n * @param {object} tx - The un-prepared transfer transaction object\n * @param {number} network - A network id\n *\n * @return {object} - A [TransferTransaction]{@link http://bob.nem.ninja/docs/#transferTransaction} object ready for serialization\n */\nlet prepare = function(common, tx, network){\n    if (!common || !tx || !network) throw new Error('Missing parameter !');\n\tlet kp = KeyPair.create(Helpers.fixPrivateKey(common.privateKey));\n    let actualSender = tx.isMultisig ? tx.multisigAccount.publicKey : kp.publicKey.toString();\n    let recipientCompressedKey = tx.recipient.toString();\n    let amount = Math.round(tx.amount * 1000000);\n    let message = Message.prepare(common, tx);\n    let msgFee = Fees.calculateMessage(message, common.isHW);\n    let due = network === Network.data.testnet.id ? 60 : 24 * 60;\n    let mosaics = null;\n    let mosaicsFee = null\n    let entity = _construct(actualSender, recipientCompressedKey, amount, message, msgFee, due, mosaics, mosaicsFee, network);\n    if (tx.isMultisig) {\n        entity = MultisigWrapper(kp.publicKey.toString(), entity, due, network);\n    }\n    return entity;\n}\n\n\n/**\n * Prepare a mosaic transfer transaction object\n *\n * @param {object} common - A common object\n * @param {object} tx - The un-prepared transfer transaction object\n * @param {object} mosaicDefinitionMetaDataPair - The mosaicDefinitionMetaDataPair object with properties of mosaics to send\n * @param {number} network - A network id\n *\n * @return {object} - A [TransferTransaction]{@link http://bob.nem.ninja/docs/#transferTransaction} object ready for serialization\n */\nlet prepareMosaic = function(common, tx, mosaicDefinitionMetaDataPair, network){\n    if (!common || !tx || !mosaicDefinitionMetaDataPair || tx.mosaics === null || !network) throw new Error('Missing parameter !');\n    let kp = KeyPair.create(Helpers.fixPrivateKey(common.privateKey));\n    let actualSender = tx.isMultisig ? tx.multisigAccount.publicKey : kp.publicKey.toString();\n    let recipientCompressedKey = tx.recipient.toString();\n    let amount = Math.round(tx.amount * 1000000);\n    let message = Message.prepare(common, tx);\n    let msgFee = Fees.calculateMessage(message, common.isHW);\n    let due = network === Network.data.testnet.id ? 60 : 24 * 60;\n    let mosaics = tx.mosaics;\n    let mosaicsFee = Fees.calculateMosaics(amount, mosaicDefinitionMetaDataPair, mosaics);\n    let entity = _construct(actualSender, recipientCompressedKey, amount, message, msgFee, due, mosaics, mosaicsFee, network);\n    if (tx.isMultisig) {\n        entity = MultisigWrapper(kp.publicKey.toString(), entity, due, network);\n    }\n    return entity;\n}\n\n/***\n * Create a transfer transaction object\n *\n * @param {string} senderPublicKey - The sender account public key\n * @param {string} recipientCompressedKey - The recipient account public key\n * @param {number} amount - The amount to send in micro XEM\n * @param {object} message - The message object\n * @param {number} due - The deadline in minutes\n * @param {array} mosaics - The array of mosaics to send\n * @param {number} mosaicFee - The fees for mosaics included in the transaction\n * @param {number} network - A network id\n *\n * @return {object} - A [TransferTransaction]{@link http://bob.nem.ninja/docs/#transferTransaction} object\n */\nlet _construct = function(senderPublicKey, recipientCompressedKey, amount, message, msgFee, due, mosaics, mosaicsFee, network) {\n    let timeStamp = Helpers.createNEMTimeStamp();\n    let version = mosaics ? Network.getVersion(2, network) : Network.getVersion(1, network);\n    let data = Objects.create(\"commonTransactionPart\")(TransactionTypes.transfer, senderPublicKey, timeStamp, due, version);\n    let fee = mosaics ? mosaicsFee : Fees.currentFeeFactor * Fees.calculateMinimum(amount / 1000000);\n    let totalFee = Math.floor((msgFee + fee) * 1000000);\n    let custom = {\n        'recipient': recipientCompressedKey.toUpperCase().replace(/-/g, ''),\n        'amount': amount,\n        'fee': totalFee,\n        'message': message,\n        'mosaics': mosaics\n    };\n    let entity = Helpers.extendObj(data, custom);\n    return entity;\n}\n\nmodule.exports = {\n    prepare,\n    prepareMosaic\n}"]}},"error":null,"hash":"371898c9925b0128f0127493b7aa2649","cacheData":{"env":{}}}